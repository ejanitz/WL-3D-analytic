(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42233,       1308]
NotebookOptionsPosition[     40390,       1242]
NotebookOutlinePosition[     40742,       1258]
CellTagsIndexPosition[     40699,       1255]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
1D resonance derivation for flat mirror r2=1, fiber mirror r1=-1\
\>", "Subsection",
 CellChangeTimes->{{3.767694982728859*^9, 3.767695009703889*^9}, {
  3.7676952294386683`*^9, 3.767695232519299*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mirror", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "^", "2"}]}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"-", "r"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "^", "2"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "r"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "^", "2"}]}], "]"}]}], ",", " ", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "^", "2"}]}], "]"}]}]}], "}"}]}], "}"}]}], ";"}], " ",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Interface", "[", 
     RowBox[{"n1_", ",", " ", "n2_"}], "]"}], ":=", " ", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"n1", "+", "n2"}], 
          RowBox[{"2", " ", "n2"}]], 
         FractionBox[
          RowBox[{
           RowBox[{"-", "n1"}], "+", "n2"}], 
          RowBox[{"2", " ", "n2"}]]},
        {
         FractionBox[
          RowBox[{
           RowBox[{"-", "n1"}], "+", "n2"}], 
          RowBox[{"2", " ", "n2"}]], 
         FractionBox[
          RowBox[{"n1", "+", "n2"}], 
          RowBox[{"2", " ", "n2"}]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "\[InvisibleSpace]", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "going", " ", "from", " ", "n1", " ", "into", " ", 
    "n2"}], " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"\[Lambda]_", ",", "n_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", "2", "*", "Pi", "*", "n", "*", 
          RowBox[{"d", "/", "\[Lambda]"}]}], "]"}], ",", " ", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], "*", "2", "*", "Pi", "*", "n", "*", 
          RowBox[{"d", "/", "\[Lambda]"}]}], "]"}]}], "}"}]}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MStacknew", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Mirror", "/.", 
       RowBox[{"r", "\[Rule]", "r1"}]}], ")"}], ".", 
     RowBox[{"L", "[", 
      RowBox[{"\[Lambda]", ",", "na", ",", "ta"}], "]"}], ".", 
     RowBox[{"Interface", "[", 
      RowBox[{"nd", ",", "na"}], "]"}], ".", 
     RowBox[{"L", "[", 
      RowBox[{"\[Lambda]", ",", "nd", ",", "td"}], "]"}], ".", 
     RowBox[{"Interface", "[", 
      RowBox[{"na", ",", "nd"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "Mirror", "]"}], "/.", 
       RowBox[{"r", "\[Rule]", "r2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Transnew", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"1", "/", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"MStacknew", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MStacknew", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Complex", "[", 
             RowBox[{"0", ",", " ", "n_"}], "]"}], "\[Rule]", " ", 
            RowBox[{"-", 
             RowBox[{"Complex", "[", 
              RowBox[{"0", ",", "n"}], "]"}]}]}]}], ")"}]}], ")"}], "]"}], 
      ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"na", "\[Rule]", "1"}], ",", " ", 
         RowBox[{"nd", ">", "0"}], ",", " ", 
         RowBox[{"td", ">", "0"}], ",", " ", 
         RowBox[{"ta", ">", "1"}], ",", " ", 
         RowBox[{"\[Lambda]", ">", "0"}], ",", 
         RowBox[{"r", "\[Element]", "Reals"}], ",", " ", 
         RowBox[{"r1", "<", "1"}], ",", " ", 
         RowBox[{"r1", ">", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"r2", "<", "1"}], ",", " ", 
         RowBox[{"r2", ">", 
          RowBox[{"-", "1"}]}]}], "}"}]}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.767695124816312*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"8", " ", 
      SuperscriptBox["na", "2"], " ", 
      SuperscriptBox["nd", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["r1", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["r2", "2"]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["na", "4"]}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["r1", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r2"}], ")"}], "2"]}], "-", 
      RowBox[{
       SuperscriptBox["nd", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["r1", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r2"}], ")"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["na", "2"], " ", 
       SuperscriptBox["nd", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         SuperscriptBox["r2", "2"], "+", 
         RowBox[{
          SuperscriptBox["r1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["r2", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"na", "-", "nd"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"na", "+", "nd"}], ")"}], " ", "r1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["na", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r2"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["nd", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "r2"}], ")"}], "2"]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "na", " ", "\[Pi]", " ", "ta"}], "\[Lambda]"], 
        "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "na"}], "+", "nd", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"na", "+", "nd"}], ")"}], " ", "r2"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"na", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r2"}], ")"}]}], "-", 
         RowBox[{"nd", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "r2"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"na", "-", "nd"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"na", "+", "nd"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r1", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"4", " ", "nd", " ", "\[Pi]", " ", "td"}], 
               "\[Lambda]"], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "na"}], "+", "nd"}], ")"}], " ", "r1", " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"4", " ", "\[Pi]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"na", " ", "ta"}], "-", 
                  RowBox[{"nd", " ", "td"}]}], ")"}]}], "\[Lambda]"], 
              "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"na", "+", "nd"}], ")"}], "2"], " ", "r1", " ", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"4", " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"na", " ", "ta"}], "+", 
               RowBox[{"nd", " ", "td"}]}], ")"}]}], "\[Lambda]"], "]"}]}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7676951425227757`*^9, 3.7676961566638727`*^9, 
  3.767698238816444*^9, 3.767698407552279*^9, 3.767699185845687*^9, 
  3.767706384855199*^9, 3.7677067575153217`*^9, 3.767709406069216*^9}]
}, Open  ]],

Cell["take limits for perfect mirror reflectivity", "Text",
 CellChangeTimes->{{3.767695267291346*^9, 3.767695284488955*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"Transnew", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["r1", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["r2", "2"]}], ")"}]}], ")"}]}], ")"}]}], ",", 
      RowBox[{"r1", "\[Rule]", 
       RowBox[{"-", "1"}]}]}], "]"}], ",", 
    RowBox[{"r2", "\[Rule]", "1"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"TrigFactor", "[", "%", "]"}], "\[Equal]", "0"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"na", "\[Rule]", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.767695311094223*^9, 3.7676953516898527`*^9}, 
   3.767706404491852*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"nd", " ", "td"}]}], ")"}]}], "\[Lambda]"], "]"}]}], 
  "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "nd"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "+", 
        RowBox[{"nd", " ", "td"}]}], ")"}]}], "\[Lambda]"], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.767695266994184*^9, {3.767695334460731*^9, 3.767695352569244*^9}, 
   3.7676961605923243`*^9, 3.767698242432049*^9, 3.7676984111246977`*^9, 
   3.767699189315813*^9, 3.767706388379648*^9, 3.767706509542223*^9, 
   3.7677067609878283`*^9, 3.767709409501314*^9}]
}, Open  ]],

Cell["\<\
write approximate resonance frequency in terms of small deviation from \
(m-1/2) FSRs\
\>", "Text",
 CellChangeTimes->{{3.767696061635829*^9, 3.7676960833610764`*^9}, {
  3.767698219558449*^9, 3.767698221992074*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "-", 
             RowBox[{"nd", " ", "td"}]}], ")"}]}], "\[Lambda]"], "]"}]}], 
       "\[Equal]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "nd"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "+", 
             RowBox[{"nd", " ", "td"}]}], ")"}]}], "\[Lambda]"], "]"}]}]}], 
      ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", 
       RowBox[{"c", "/", "\[Nu]"}]}], "}"}]}], "/.", 
    RowBox[{"\[Nu]", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", 
          RowBox[{"1", "/", "2"}]}], ")"}], "*", 
        RowBox[{"c", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"ta", "+", 
             RowBox[{"nd", "*", "td"}]}], ")"}]}], ")"}]}]}], "+", 
       "\[Delta]\[Nu]"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"TrigFactor", "[", "%", "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.767696025549776*^9, 3.7676960552782383`*^9}, {
   3.7676961012807283`*^9, 3.76769613673587*^9}, {3.767697452620607*^9, 
   3.7676974748829927`*^9}, {3.7676981587870626`*^9, 3.767698160811117*^9}, {
   3.767698334521842*^9, 3.767698342151368*^9}, 3.767698625195157*^9, {
   3.767699162357634*^9, 3.767699162760104*^9}, {3.767706310820422*^9, 
   3.767706311197588*^9}, 3.767706530892095*^9, {3.767706673573635*^9, 
   3.767706678965323*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"nd", " ", "td"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "m"}]}], ")"}]}], 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}], ")"}]}]], "+", "\[Delta]\[Nu]"}], 
       ")"}]}], "c"], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "nd"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{"m", "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "+", 
           RowBox[{"nd", " ", "td"}]}], ")"}], " ", "\[Delta]\[Nu]"}], "c"]}],
       ")"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.767706878667861*^9, 3.7677095353190403`*^9}]
}, Open  ]],

Cell["Factor on LHS is smaller, neglect this term:", "Text",
 CellChangeTimes->{{3.767697666016354*^9, 3.7676976835705633`*^9}, 
   3.767699566716546*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"ta", "-", 
         RowBox[{"nd", " ", "td"}]}], ")"}], " ", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "m"}]}], ")"}]}], 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}], ")"}]}]], ")"}]}], "c"], "]"}]}], 
   "\[Equal]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "nd"}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}], ")"}], " ", "\[Delta]\[Nu]"}], 
         "c"]}], ")"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"TrigFactor", "[", "%", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.767697694274284*^9, 3.767697712146966*^9}, {
   3.76769871917902*^9, 3.7676987263035297`*^9}, 3.767698765721471*^9, {
   3.767699552419632*^9, 3.767699560868352*^9}, {3.767706961582946*^9, 
   3.767706978039343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"m", " ", "ta"}], "+", 
        RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}]], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "nd"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{"m", "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "+", 
           RowBox[{"nd", " ", "td"}]}], ")"}], " ", "\[Delta]\[Nu]"}], "c"]}],
       ")"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.767697696602746*^9, 3.767697713916891*^9}, 
   3.767698528065254*^9, 3.767698729756008*^9, 3.76769876711933*^9, 
   3.767699308467939*^9, 3.767699563800613*^9, 3.767706506596321*^9, 
   3.767706880419842*^9, 3.767706980484922*^9, 3.767709536823071*^9}]
}, Open  ]],

Cell["\<\
Use sum-product rules for RHS (sin(a+b)=cos(b) sin(a) + cos(a) sin(b)):\
\>", "Text",
 CellChangeTimes->{{3.7676977373774843`*^9, 3.767697751525549*^9}, {
  3.767697808594145*^9, 3.767697813975691*^9}, {3.767697872869158*^9, 
  3.76769787602022*^9}, {3.7676996691654787`*^9, 3.767699673519883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Nu]resnew", " ", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{"ta", "-", 
            RowBox[{"m", " ", "ta"}], "+", 
            RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
         RowBox[{"ta", "+", 
          RowBox[{"nd", " ", "td"}]}]], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "nd"}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "m"}], "*", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "+", 
              RowBox[{"nd", " ", "td"}]}], ")"}], " ", "\[Delta]\[Nu]"}], 
           "c"], ")"}]}], "]"}]}]}], "\[Equal]", "0"}], ",", 
    "\[Delta]\[Nu]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.767697927883984*^9, 3.767698006196031*^9}, {
  3.7676987763202667`*^9, 3.767698806366487*^9}, {3.767699732652883*^9, 
  3.76769976658213*^9}, {3.767707008832037*^9, 3.7677070124595623`*^9}, {
  3.767707051725505*^9, 3.76770706004403*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Delta]\[Nu]", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "-", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"-", "m"}]], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "-", 
                   RowBox[{"m", " ", "ta"}], "+", 
                   RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
                RowBox[{"ta", "+", 
                 RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
             RowBox[{"1", "+", "nd"}]], "]"}], "+", 
           RowBox[{"2", " ", "\[Pi]", " ", 
            RowBox[{"C", "[", "1", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "+", 
           RowBox[{"nd", " ", "td"}]}], ")"}]}]], ",", 
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]\[Nu]", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"-", "m"}]], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "-", 
                   RowBox[{"m", " ", "ta"}], "+", 
                   RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
                RowBox[{"ta", "+", 
                 RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
             RowBox[{"1", "+", "nd"}]], "]"}], "+", 
           RowBox[{"2", " ", "\[Pi]", " ", 
            RowBox[{"C", "[", "1", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "+", 
           RowBox[{"nd", " ", "td"}]}], ")"}]}]], ",", 
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.767697969423645*^9, 3.767697976539431*^9}, 
   3.7676980071099567`*^9, 3.767698528224888*^9, {3.767698783192951*^9, 
   3.767698806837027*^9}, 3.767699308638865*^9, 3.767699774611158*^9, 
   3.7677065067491093`*^9, 3.767706880542911*^9, 3.7677070688491173`*^9, 
   3.767709536939377*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"f1new", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", 
           RowBox[{"1", "/", "2"}]}], ")"}], "*", 
         RowBox[{"c", "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"ta", "+", 
              RowBox[{"nd", "*", "td"}]}], ")"}]}], ")"}]}]}], "+", 
        "\[Delta]\[Nu]"}], "/.", 
       RowBox[{"\[Nu]resnew", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "n"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"n", "\[Element]", "Integers"}], "}"}]}]}], "]"}], "/.", 
   RowBox[{"n", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"f2new", " ", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", 
           RowBox[{"1", "/", "2"}]}], ")"}], "*", 
         RowBox[{"c", "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"ta", "+", 
              RowBox[{"nd", "*", "td"}]}], ")"}]}], ")"}]}]}], "+", 
        "\[Delta]\[Nu]"}], "/.", 
       RowBox[{"\[Nu]resnew", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "n"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"n", "\[Element]", "Integers"}], "}"}]}]}], "]"}], "/.", 
   RowBox[{"n", "\[Rule]", "0"}]}]}]}], "Input",
 CellChangeTimes->{{3.767697606279377*^9, 3.7676976067030163`*^9}, 
   3.767698029372274*^9, {3.7676988160637293`*^9, 3.767698822014965*^9}, {
   3.7677007053576727`*^9, 3.7677007096259127`*^9}, {3.7677073807611322`*^9, 
   3.76770739579359*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", "+", 
     RowBox[{"2", " ", "m", " ", "\[Pi]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"-", "m"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"m", " ", "ta"}], "+", 
              RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
        RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "+", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.76769852831478*^9, 3.767698826558712*^9, 3.767699308730927*^9, 
   3.767699786350196*^9, 3.7677007102100697`*^9, 3.767706506851787*^9, 
   3.767706880626775*^9, 3.7677070903227797`*^9, {3.767707382305286*^9, 
   3.767707396214108*^9}, 3.7677095370224323`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[Pi]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"-", "m"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"m", " ", "ta"}], "+", 
              RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
        RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "+", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.76769852831478*^9, 3.767698826558712*^9, 3.767699308730927*^9, 
   3.767699786350196*^9, 3.7677007102100697`*^9, 3.767706506851787*^9, 
   3.767706880626775*^9, 3.7677070903227797`*^9, {3.767707382305286*^9, 
   3.767707396214108*^9}, 3.7677095370367804`*^9}]
}, Open  ]],

Cell["ArcSin(-x)=-ArcSin(x)", "Text",
 CellChangeTimes->{
  3.7676988648863277`*^9, 3.7676990349685583`*^9, {3.7676998573936577`*^9, 
   3.767699876176655*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"f11new", "=", " ", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "+", 
      RowBox[{"2", " ", "m", " ", "\[Pi]"}], "-", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "m"], "*", " ", 
       RowBox[{"ArcSin", "[", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"\[Pi]", " ", 
              RowBox[{"(", 
               RowBox[{"ta", "-", 
                RowBox[{"m", " ", "ta"}], "+", 
                RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
             RowBox[{"ta", "+", 
              RowBox[{"nd", " ", "td"}]}]], "]"}]}]}], 
         RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}], ")"}]}]]}], "\[IndentingNewLine]", 
 RowBox[{"f22new", "=", " ", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[Pi]"}], "+", 
      RowBox[{"2", " ", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "m"], "*", 
       RowBox[{"ArcSin", "[", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"\[Pi]", " ", 
              RowBox[{"(", 
               RowBox[{"ta", "-", 
                RowBox[{"m", " ", "ta"}], "+", 
                RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
             RowBox[{"ta", "+", 
              RowBox[{"nd", " ", "td"}]}]], "]"}]}]}], 
         RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}], 
     ")"}]}]]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.767699050421883*^9, 3.767699093026582*^9}, {
  3.767699884842852*^9, 3.767699890688849*^9}, {3.767699926327076*^9, 
  3.767699931710294*^9}, {3.7677007394279747`*^9, 3.7677007647770967`*^9}, {
  3.767707108767576*^9, 3.767707165198142*^9}, {3.767707198590849*^9, 
  3.767707205052115*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", "+", 
     RowBox[{"2", " ", "m", " ", "\[Pi]"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "m"], " ", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"m", " ", "ta"}], "+", 
              RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
        RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "+", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.767699093742263*^9, 3.7676993088407516`*^9, 
  3.767699934147929*^9, 3.767700765335113*^9, 3.767706506972727*^9, 
  3.767706880725396*^9, 3.7677072064254313`*^9, 3.767709537107195*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[Pi]"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "m"], " ", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"m", " ", "ta"}], "+", 
              RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
        RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "+", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.767699093742263*^9, 3.7676993088407516`*^9, 
  3.767699934147929*^9, 3.767700765335113*^9, 3.767706506972727*^9, 
  3.767706880725396*^9, 3.7677072064254313`*^9, 3.767709537118045*^9}]
}, Open  ]],

Cell["look at f22new -> sin(a)=cos(-a+Pi/2)", "Text",
 CellChangeTimes->{{3.767707308547346*^9, 3.767707364206053*^9}, {
  3.767707779782668*^9, 3.767707781091281*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"m", " ", "ta"}], "+", 
        RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}]], "]"}], "\[Equal]", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{"ta", "-", 
          RowBox[{"m", " ", "ta"}], "+", 
          RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
       RowBox[{"ta", "+", 
        RowBox[{"nd", " ", "td"}]}]]}], "+", 
     RowBox[{"Pi", "/", "2"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.767707791076728*^9, 3.767707807618527*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7677078082529573`*^9, 3.767709537195887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{"ta", "-", 
          RowBox[{"m", " ", "ta"}], "+", 
          RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
       RowBox[{"ta", "+", 
        RowBox[{"nd", " ", "td"}]}]]}], "+", 
     RowBox[{"Pi", "/", "2"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"m", "-", 
     RowBox[{"1", "/", "2"}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7677080246072617`*^9, 3.76770803499627*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "-", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}], 
  RowBox[{"ta", "+", 
   RowBox[{"nd", " ", "td"}]}]]], "Output",
 CellChangeTimes->{{3.767708029894055*^9, 3.7677080353614597`*^9}, 
   3.767709537273818*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"f11new", "/.", 
  RowBox[{
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"m", " ", "ta"}], "+", 
        RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}]], "]"}], "\[Rule]", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"\[Pi]", 
      RowBox[{"(", 
       RowBox[{"m", "-", 
        RowBox[{"1", "/", "2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"nd", " ", "td"}]}], ")"}]}], 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}]], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"f22new", "/.", 
  RowBox[{
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"m", " ", "ta"}], "+", 
        RowBox[{"m", " ", "nd", " ", "td"}]}], ")"}]}], 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}]], "]"}], "\[Rule]", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"\[Pi]", 
      RowBox[{"(", 
       RowBox[{"m", "-", 
        RowBox[{"1", "/", "2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", 
        RowBox[{"nd", " ", "td"}]}], ")"}]}], 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}]], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.767708054622259*^9, 3.767708086251978*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", "+", 
     RowBox[{"2", " ", "m", " ", "\[Pi]"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "m"], " ", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["1", "2"]}], "+", "m"}], ")"}], " ", "\[Pi]", " ", 
            
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"nd", " ", "td"}]}], ")"}]}], 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
        RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "+", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.7677080776759357`*^9, 3.767708087708559*^9}, 
   3.7677095373511868`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[Pi]"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "m"], " ", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["1", "2"]}], "+", "m"}], ")"}], " ", "\[Pi]", " ", 
            
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"nd", " ", "td"}]}], ")"}]}], 
           RowBox[{"ta", "+", 
            RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
        RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"ta", "+", 
     RowBox[{"nd", " ", "td"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.7677080776759357`*^9, 3.767708087708559*^9}, 
   3.7677095373648148`*^9}]
}, Open  ]],

Cell[TextData[{
 "So the final expression is ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", 
         RowBox[{"1", "/", "2"}]}], ")"}], " ", "\[Pi]"}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "m"], " ", 
       RowBox[{"ArcSin", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "nd"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "2"]}], "+", "m"}], ")"}], " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{"ta", "-", 
               RowBox[{"nd", " ", "td"}]}], ")"}]}], 
            RowBox[{"ta", "+", 
             RowBox[{"nd", " ", "td"}]}]], "]"}]}], 
         RowBox[{"1", "+", "nd"}]], "]"}]}]}], ")"}]}], 
   RowBox[{"2", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "+", 
      RowBox[{"nd", " ", "td"}]}], ")"}]}]]],
  CellChangeTimes->{{3.7677080776759357`*^9, 3.767708087729109*^9}}],
 ", which matches the old derivation with m->m-1/2 in the argument of the \
cosine. Now we try to rederive this for a 3D system with Guoy phase..."
}], "Text",
 CellChangeTimes->{{3.767708146263609*^9, 3.767708166907947*^9}, {
  3.767708428464061*^9, 3.767708458639515*^9}}]
}, Open  ]]
},
WindowSize->{808, 682},
WindowMargins->{{Automatic, 0}, {Automatic, 5}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 211, 4, 44, "Subsection"],
Cell[CellGroupData[{
Cell[816, 30, 5133, 148, 343, "Input"],
Cell[5952, 180, 4400, 130, 210, "Output"]
}, Open  ]],
Cell[10367, 313, 125, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[10517, 318, 1015, 30, 53, "Input"],
Cell[11535, 350, 895, 27, 47, "Output"]
}, Open  ]],
Cell[12445, 380, 226, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[12696, 389, 1960, 55, 119, "Input"],
Cell[14659, 446, 1159, 38, 59, "Output"]
}, Open  ]],
Cell[15833, 487, 154, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[16012, 493, 1436, 43, 80, "Input"],
Cell[17451, 538, 1069, 31, 48, "Output"]
}, Open  ]],
Cell[18535, 572, 308, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[18868, 581, 1359, 38, 95, "Input"],
Cell[20230, 621, 3065, 81, 208, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23332, 707, 1936, 56, 80, "Input"],
Cell[25271, 765, 1266, 35, 73, "Output"],
Cell[26540, 802, 1350, 39, 73, "Output"]
}, Open  ]],
Cell[27905, 844, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[28090, 851, 2532, 72, 167, "Input"],
Cell[30625, 925, 1153, 32, 73, "Output"],
Cell[31781, 959, 1237, 36, 73, "Output"]
}, Open  ]],
Cell[33033, 998, 168, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[33226, 1004, 783, 24, 49, "Input"],
Cell[34012, 1030, 97, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34146, 1036, 585, 18, 49, "Input"],
Cell[34734, 1056, 297, 9, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35068, 1070, 1423, 45, 88, "Input"],
Cell[36494, 1117, 1141, 35, 90, "Output"],
Cell[37638, 1154, 1225, 39, 90, "Output"]
}, Open  ]],
Cell[38878, 1196, 1496, 43, 122, "Text"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
